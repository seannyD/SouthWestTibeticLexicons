bb["y","max"]= 34.7
bb["y","min"]= 25.48
bb["x","max"]= 101
bb["x","min"]= 82
cm <- get_map(bb,source = "osm")
cmap = ggmap(cm)
cmap + geom_point(aes(x=long,y=lat),data=d)
?geom_label
cmap + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=language))
cmap + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=language),data=d)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d = d[d$source=="DND",]
range(d$lat)
typeof(bb)
bb
matrix(1:4,nrow=2)
range(d$long)
bb
range(d$lat)
bb = matrix(
c(83,27,88,29.2), ncol=2
)
rownames(bb) = c("x","y")
colnames(bb) = c("min","max")
bb
cm <- get_map(bb,source = "osm")
cmap = ggmap(cm)
cmap + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=language),data=d)
d = d[order(d$lat,d$long),]
d$language
d = d[rev(order(d$lat,d$long)),]
d$language
d$label = paste0(1:nrow(d)". ",d$language)
d$label = paste0(1:nrow(d),". ",d$language)
d$label
cmap = ggmap(cm)
cmap + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=label),data=d)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
cmap = ggmap(cm)
cmap + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="DND",])
d = d[rev(order(d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
cmap = ggmap(cm)
cmap + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="DND",])
bb2 = matrix(c(83,25,101.5,35), ncol=2)
rownames(bb) = c("x","y")
colnames(bb) = c("min","max")
bb2 = matrix(c(83,25,101.5,35), ncol=2)
rownames(bb2) = c("x","y")
colnames(bb2) = c("min","max")
cm2 <- get_map(bb2,source = "osm")
cmap2 = ggmap(cm2)
cmap2 + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="S",])
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d = d[rev(order(d$source,d$lat,d$long)),]
d$language
d = d[(order(d$source,d$lat,d$long,decreasing = T)),]
d$language
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("DND","S"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$language
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$language
d$label = paste0(1:nrow(d),". ",d$language)
d[d$language=="Alike",]$lat = d[d$language=="Alike",]$lat+0.5
cmap2 = ggmap(cm2)
cmap2 + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="S",])
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d[d$language=="Alike",]$lat = d[d$language=="Alike",]$lat-0.5
cmap2 = ggmap(cm2)
cmap2 + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="S",])
?ggmap
cmap = ggmap(cm)
cmap + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="DND",])
cmap2 = cmap2 + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="S",])
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="DND",])
cmap + annotation_custom(ggplotGrob(cmap2),
xmin = 85.8, xmax = 87.9,
ymin = 28.25, ymax = 29.1)
cmap + inset(ggplotGrob(cmap2),
xmin = 85.8, xmax = 87.9,
ymin = 28.25, ymax = 29.1)
??editGrob
library(ggplot2)
library(grid)
cmap + inset(ggplotGrob(cmap2),
xmin = 85.8, xmax = 87.9,
ymin = 28.25, ymax = 29.1)
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap2
cmap + inset(ggplotGrob(cmap2),
xmin = 85.8, xmax = 87.9,
ymin = 28.25, ymax = 29.1)
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 85, xmax = 88,
ymin = 27.8, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 85, xmax = 88,
ymin = 28, ymax = 29.2)
cmap
cmap + inset(ggplotGrob(cmap2),
xmin = 85.5, xmax = 88,
ymin = 28, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 86, xmax = 88,
ymin = 28, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 86, xmax = 88,
ymin = 27.5, ymax = 29.2)
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat-0.25,label=label),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat-0.1,label=label),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 86, xmax = 88,
ymin = 27.5, ymax = 29.2)
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long-0.2,y=lat,label=label),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long-0.3,y=lat,label=label),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
?ggeom_leg
?geom_label
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label,hjust="left"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long-0.05,y=lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
cm2 <- get_map(bb2,source = "osm")
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long,y=lat,label=label),data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 86, xmax = 88,
ymin = 27.5, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 86, xmax = 88,
ymin = 27.5, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.5, ymax = 29.2)
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long-0.1,y=lat,label=label,hjust="right"),data=d[d$source=="S",]) +
theme(axis.title = element_blank())
bb2 = matrix(c(83.5,25,101.5,35), ncol=2)
rownames(bb2) = c("x","y")
colnames(bb2) = c("min","max")
cm2 <- get_map(bb2,source = "osm")
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long-0.1,y=lat,label=label,hjust="right"),data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.5, ymax = 29.2)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d[d$language=="Alike",]$lat = d[d$language=="Alike",]$lat-1
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=long-0.1,y=lat,label=label,hjust="right"),data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.5, ymax = 29.2)
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long-0.05,y=lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d$label.lat = d$lat
d$label.long = d$long
d[d$language=="Alike",]$label.lat = d[d$language=="Alike",]$label.lat-1
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=label.long-0.1,y=label.lat,label=label,hjust="right"),data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.8, ymax = 29.2)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d$label.lat = d$lat
d$label.long = d$long
d[d$language=="Alike",]$label.lat = d[d$language=="Alike",]$label.lat-1
d[d$language=="Old Tibetan",]$label.lat = d[d$language=="Old Tibetan",]$label.lat+0.5
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat),data=d) +
geom_label(aes(x=label.long-0.15,y=label.lat,label=label,hjust="right"),data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.8, ymax = 29.2)
cmap2 = ggmap(cm2) +
geom_label(aes(x=label.long-0.15,y=label.lat,label=label,hjust="right"),
data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.8, ymax = 29.2)
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long-0.15,y=label.lat,label=label,hjust="right"),
data=d[d$source=="S",]) +
theme(axis.title = element_blank())
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.8, ymax = 29.2)
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long-0.15,y=label.lat,label=label,hjust="right"),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend. position = "none")
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long-0.15,y=label.lat,label=label,hjust="right"),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend. position = "none")
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long-0.15,y=label.lat,label=label,hjust="right"),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.8, ymax = 29.2)
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long-0.2,y=label.lat,label=label,hjust="right"),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.8, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 28, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.8, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.85, ymax = 29.2)
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.86, ymax = 29.2)
bb2 = matrix(c(83.5,25,101.5,35.1), ncol=2)
rownames(bb2) = c("x","y")
colnames(bb2) = c("min","max")
cm2 <- get_map(bb2,source = "osm")
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long-0.2,y=label.lat,label=label,hjust="right"),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.86, ymax = 29.2)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d$label.lat = d$lat
d$label.long = d$long
d[d$language=="Alike",]$label.lat = d[d$language=="Alike",]$label.lat-1
d[d$language=="Old Tibetan",]$label.lat = d[d$language=="Old Tibetan",]$label.lat+0.5
d[d$source=="DND",]$label.long = d[d$source=="DND",]$label.long-0.05
d[d$source=="S",]$label.long = d[d$source=="S",]$label.long-0.2
d[d$language=="Lhasa",]$label.long = d[d$language=="Lhasa",]$label.long +0.4
d$hjust = "right"
d[d$language=="Lhasa",]$hjust = "left"
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust=hjust),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.86, ymax = 29.2)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d$label.lat = d$lat
d$label.long = d$long
d[d$language=="Alike",]$label.lat = d[d$language=="Alike",]$label.lat-1
d[d$language=="Old Tibetan",]$label.lat = d[d$language=="Old Tibetan",]$label.lat+0.5
d[d$source=="DND",]$label.long = d[d$source=="DND",]$label.long-0.5
d[d$source=="S",]$label.long = d[d$source=="S",]$label.long-0.2
d[d$language=="Lhasa",]$label.long = d[d$language=="Lhasa",]$label.long +0.4
d$hjust = "right"
d[d$language=="Lhasa",]$hjust = "left"
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=long,y=lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust=hjust),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.86, ymax = 29.2)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d$label.lat = d$lat
d$label.long = d$long
d[d$language=="Alike",]$label.lat = d[d$language=="Alike",]$label.lat-1
d[d$language=="Old Tibetan",]$label.lat = d[d$language=="Old Tibetan",]$label.lat+0.5
d[d$source=="DND",]$label.long = d[d$source=="DND",]$label.long-0.5
d[d$source=="S",]$label.long = d[d$source=="S",]$label.long-0.2
d[d$language=="Lhasa",]$label.long = d[d$language=="Lhasa",]$label.long +0.4
d$hjust = "right"
d[d$language=="Lhasa",]$hjust = "left"
#d = d[d$source=="DND",]
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust=hjust),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.86, ymax = 29.2)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d$label.lat = d$lat
d$label.long = d$long
d[d$language=="Alike",]$label.lat = d[d$language=="Alike",]$label.lat-1
d[d$language=="Old Tibetan",]$label.lat = d[d$language=="Old Tibetan",]$label.lat+0.05
d[d$source=="DND",]$label.long = d[d$source=="DND",]$label.long-0.5
d[d$source=="S",]$label.long = d[d$source=="S",]$label.long-0.2
d[d$language=="Lhasa",]$label.long = d[d$language=="Lhasa",]$label.long +0.4
d$hjust = "right"
d[d$language=="Lhasa",]$hjust = "left"
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust=hjust),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.86, ymax = 29.2)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d$label.lat = d$lat
d$label.long = d$long
d[d$language=="Alike",]$label.lat = d[d$language=="Alike",]$label.lat-1
d[d$language=="Old Tibetan",]$label.lat = d[d$language=="Old Tibetan",]$label.lat+0.05
d[d$source=="DND",]$label.long = d[d$source=="DND",]$label.long-0.5
d[d$source=="S",]$label.long = d[d$source=="S",]$label.long-0.25
d[d$language=="Lhasa",]$label.long = d[d$language=="Lhasa",]$label.long +0.5
d$hjust = "right"
d[d$language=="Lhasa",]$hjust = "left"
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust=hjust),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.86, ymax = 29.2)
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap
head(d)
d = read.csv("../data/langaugeLocation.csv",stringsAsFactors = F,quote="")
d$source = factor(d$source,levels=c("S","DND"))
d = d[rev(order(d$source,d$lat,d$long)),]
d$label = paste0(1:nrow(d),". ",d$language)
d$label.lat = d$lat
d$label.long = d$long
d[d$language=="Alike",]$label.lat = d[d$language=="Alike",]$label.lat-1
d[d$language=="Old Tibetan",]$label.lat = d[d$language=="Old Tibetan",]$label.lat+0.5
d[d$source=="DND",]$label.long = d[d$source=="DND",]$label.long-0.05
d[d$source=="S",]$label.long = d[d$source=="S",]$label.long-0.25
d[d$language=="Lhasa",]$label.long = d[d$language=="Lhasa",]$label.long +0.5
d$hjust = "right"
d[d$language=="Lhasa",]$hjust = "left"
cmap = ggmap(cm) + geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust="right"),data=d[d$source=="DND",])+
theme(axis.title = element_blank())
cmap2 = ggmap(cm2) + geom_point(aes(x=long,y=lat,colour="red"),data=d[d$source=="S",]) +
geom_point(aes(x=long,y=lat),data=d[d$source=="DND",]) +
geom_label(aes(x=label.long,y=label.lat,label=label,hjust=hjust),
data=d[d$source=="S",]) +
theme(axis.title = element_blank(),legend.position = "none")
cmap + inset(ggplotGrob(cmap2),
xmin = 85.7, xmax = 88,
ymin = 27.86, ymax = 29.2)
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel)))))));")
library(ape)
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel)))))));")
plot(glottologTree,cex=1)
glottologTree = ladderize(glottologTree)
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel))))));")
plot(glottologTree,cex=1)
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel))))));")
glottologTree = ladderize(glottologTree)
plot(glottologTree,cex=1)
plot(glottologTree,cex=1,main="Glottolog tree")
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan:1,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel))))));")
glottologTree = ladderize(glottologTree)
plot(glottologTree,cex=1,main="Glottolog tree")
compute.brlen(glottologTree)
glottologTree = compute.brlen(glottologTree)
plot(glottologTree)
mytree$edge.length
glottologTree$edge.length
glottologTree$edge.length[22] = 0.3
plot(glottologTree)
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan:1,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel))))));")
glottologTree = ladderize(glottologTree)
glottologTree$edge.length[22] = 0.3
plot(glottologTree,cex=1,main="Glottolog tree")
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan:1,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel))))));")
glottologTree = compute.brlen(glottologTree)
glottologTree$edge.length[22] = 0.3
glottologTree = ladderize(glottologTree)
plot(glottologTree,cex=1,main="Glottolog tree")
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan:1,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel))))));")
glottologTree = compute.brlen(glottologTree)
glottologTree$edge.length
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan:1,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel))))));")
glottologTree = compute.brlen(glottologTree)
glottologTree$edge.length[1] = 0.3
glottologTree = ladderize(glottologTree)
plot(glottologTree,cex=1,main="Glottolog tree")
#glottologTree = read.tree(text="(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel));")
glottologTree = read.tree(text="(Old Tibetan:1,((Alike,Xiahe),(Batang,(Lhasa,(((Gyalsumdo,Nubri),Tsum,(Yolmo,Kagate)),Lowa,(Sherpa,Jirel))))));")
glottologTree = compute.brlen(glottologTree)
glottologTree$edge.length[1] = 0.3
glottologTree = ladderize(glottologTree)
plot(glottologTree,cex=1,main="Glottolog tree")
plot(glottologTree,cex=1,main="Glottolog tree",col=1:2)
plot.phylo()
?plot.phylo()
plot(glottologTree,cex=1,main="Glottolog tree",tip.color=1:2)
plot(glottologTree,cex=1,main="Glottolog tree",tip.color=c(1,1,1,1,1,2,2,2,2,2,2,2))
plot(glottologTree,cex=1,main="Glottolog tree",tip.color=c(1,1,1,1,1,2,2,2,2,2,2,2,2))
