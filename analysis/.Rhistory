s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re')+
s(fyear,bs="re") +
s(indus,bs="re"),
data=d2
)
mgam = bam(
AAM ~
strongftr +
s(invpro,K=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re')+
s(fyear,bs="re") +
s(indus,bs="re"),
data=d2
)
mgam = bam(
AAM ~
strongftr +
s(invpro,k=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re'),
data=d2
)
mgam = bam(
AAM ~
strongftr +
s(invpro) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re'),
data=d2
)
mgam = bam(
AAM ~
strongftr +
s(invpro,k=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re'),
data=d2
)
?s
mgam = bam(
AAM ~
strongftr +
s(invpro,k=3) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re'),
data=d2
)
mgam = bam(
AAM ~
strongftr +
s(invpro,k=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(mainLanguageFamily,bs='re'),
data=d2
)
mgam = bam(
AAM ~
strongftr +
s(invpro,k=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul),
data=d2
)
d2$mainLanguageFamily = factor(d2$mainLanguageFamily)
mgam = bam(
AAM ~
strongftr +
s(invpro,k=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re'),
data=d2
)
plot(mgam)
summary(mgam)
?bam
mgam = bam(
AAM ~
strongftr +
s(invpro,k=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re'),
data=d2,
family = Gamma
)
mgam = bam(
AAM3 ~
strongftr +
s(invpro,k=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re'),
data=d2,
family = Gamma
)
d2$AAM3 = d2$AAM+0.001
mgam = bam(
AAM3 ~
strongftr +
s(invpro,k=4) +
s(pd) + s(indiv) + s(mas) + s(ua) + s(lto) + s(indul) +
s(ggr) +
s(SIZE) + s(BTM) + s(LEV) + s(ROA) +
MEET + LOSS +
s(mainLanguageFamily,bs='re'),
data=d2,
family = Gamma
)
summary(mgam)
plot(mgam$data$AAM)
plot(d2$AAM,predict(mgam))
hist(predict(mgam))
mA0 = glmer(AAM2 ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma)
mA0 = glmer(AAM2+1 ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma)
mA0 = glmer(AAM2+1 ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma,
control=glmerControl(optimizer = 'Nelder_Mead'))
summary(mA0)
mA0 = glmer(AAM2+0.001 ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma,
control=glmerControl(optimizer = 'Nelder_Mead'))
mA0 = glmer(AAM+0.001 ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma,
control=glmerControl(optimizer = 'Nelder_Mead'))
hist(d2$AAM2)
apply(d2,2,function(X){sum(is.na(X))})
sort(apply(d2,2,function(X){sum(is.na(X))}))
d2 = d2[complete.cases(d2[,
c("AAM","pd",'indiv',
'lto','mas','ua','LEV')]),]
head(d2)
hist(d2$AAM)
hist(log(d2$AAM))
hist(log(d2$AAM+1))
hist(log(log(d2$AAM+1)+1))
hist(log(log(log(d2$AAM+1)+1)+1))
hist(log(log(log(log(d2$AAM+1)+1)+1)+1))
mA0 = glmer(AAM2 ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2)
hist(predict(mA0))
hist(d2$AAM2)
dim(mA0@frame)
dim(d2)
keyVar = c("invpro","pd","indiv","mas",
"ua","lto","indul","ggr","SIZE",
"BTM","LEV","ROA","MEET","LOSS")
d2 = d2[complete.cases(d2[,keyVar,]),]
dim(d2)
dim(mA0@frame)
hist(d2$AAM)
d2$AAM2 = log(1+d2$AAM)
d2$AAM2 = d2$AAM2 - median(d2$AAM2,na.rm = T)
hist(d2$AAM2)
hist(d2$AAM[d2$AAM<0.01],breaks=100)
plot(density(d2$AAM),xlim=c(0,3))
hist(d2$AAM,xlim=c(0,3),breaks=500,freq = F)
curve(dgamma(x,
scale=0.14,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
hist(d2$AAM2)
hist(d2$AAM2[d2$AAM2<0.1],breaks=100)
hist(d2$AAM,xlim=c(0,3),breaks=500,freq = F)
hist(d2$AAM2,xlim=c(0,3),breaks=500,freq = F)
curve(dgamma(x,
scale=0.14,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.14,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
curve(dgamma(x,
scale=0.13,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
curve(dgamma(x,
scale=0.2,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
curve(dgamma(x,
scale=0.2,
shape=1.5
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
d2$AAM2 = log(1+d2$AAM)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.2,
shape=1.5
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
curve(dgamma(x,
scale=0.2,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
curve(dgamma(x,
scale=0.3,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
curve(dgamma(x,
scale=0.1,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
curve(dgamma(x,
scale=0.15,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
curve(dgamma(x,
scale=0.18,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.18,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=300,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.18,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
curve(dgamma(x,
scale=0.18,
shape=1.1
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.1,
shape=1.1
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.05,
shape=1.2
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.08,
shape=1.2
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.08,
shape=1.1
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.08,
shape=1.3
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.1,
shape=1.3
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.03,
shape=1.3
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.03,
shape=2
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.03,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.03,
shape=1.8
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.1,
shape=1.8
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
curve(dgamma(x,
scale=0.1,
shape=1.2
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.2,
shape=1.2
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
hist(d2$AAM2,xlim=c(0,3),breaks=100,freq = F)
curve(dgamma(x,
scale=0.2,
shape=1
),from=0,to=max(d2$AAM,na.rm=T), n=500,
add=T,col=2)
?exponential
?exponential
?family
mA0 = glmer(AAM ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma(link = 'identity'))
mA0 = glmer(1+AAM ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma(link = 'identity'))
mA0 = glmer(1+AAM ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma(link = 'identity'))
log(1)
mA0 = glmer(1+AAM ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=Gamma(link = 'log'))
summary(mA0)
hist(predict(mA0))
hist(exp(predict(mA0)))
hist(exp(predict(mA0))-1)
hist(exp(predict(mA0)-1))
abline(v=0)
hist(d2$AAM)
hist(predict(mA0))
hist(exp(predict(mA0)))
hist(exp(predict(mA0))-1)
ranef(mA0)
plot(d2$AAM,predict(mA0))
plot(d2$AAM,exp(predict(mA0)))
mA0 = glmer(1+AAM ~ 1 +
invpro +
pd + indiv + mas + ua + lto + indul +
ggr +
SIZE + BTM + LEV + ROA +
MEET + LOSS +
(1 | fyear) +
(1 | indus),
data = d2,
family=inverse.gaussian(link = 'log'))
summary(mA0)
hist(predict(mA9))
hist(predict(mA0))
hist(d2$AAM)
hist(log(d2$AAM+1))
hist(exp(d2$AAM))
hist(exp(d2$AAM),xlim=c(0,5))
hist(exp(d2$AAM),xlim=c(0,5),breaks=100)
setwd("~/Documents/Funding/InternationalStrategicFund/project/analysis/")
kagate = read.csv("../data/processed/Kagate.tsv",sep="\t",quote="")
yolmo = read.csv("../data/processed/Yolmo.tsv",sep="\t",quote="")
head(yolmo)
kagate$Y = yolmo[match(kagate$CONCEPT,yolmo$CONCEPT),]$TRANSCRIPTION
kagate[,c("TRANSCRIPTION","Y")]
kagate[,c("TRANSCRIPTION","Y")]
kagate = read.csv("../data/processed/Kagate.tsv",sep="\t",quote="",stringsAsFactors = F)
yolmo = read.csv("../data/processed/Yolmo.tsv",sep="\t",quote="",stringsAsFactors = F)
kagate$Y = yolmo[match(kagate$CONCEPT,yolmo$CONCEPT),]$TRANSCRIPTION
head(kagate)
d = kagate[!is.na(kagate$Y),]
dim(d)
head(d)
head(yolmo$CONCEPT)
kagate = read.csv("../data/processed/Kagate.tsv",sep="\t",quote="",stringsAsFactors = F)
yolmo = read.csv("../data/processed/Yolmo.tsv",sep="\t",quote="",stringsAsFactors = F)
yolmo = yolmo[yolmo$CONCEPT!="",]
kagate$Y = yolmo[match(kagate$CONCEPT,yolmo$CONCEPT),]$TRANSCRIPTION
d = kagate[!is.na(kagate$Y),]
dim(d)
head(d)
d[,c("TRANSCRIPTION","Y"),]
d[,c("CONCEPT","TRANSCRIPTION","Y"),]
kagate = read.csv("../data/processed/Kagate.tsv",sep="\t",quote="",stringsAsFactors = F,encoding = "UTF-8",fileEncoding = "UTF-8")
yolmo = read.csv("../data/processed/Yolmo.tsv",sep="\t",quote="",stringsAsFactors = F,
encoding = "UTF-8",fileEncoding = "UTF-8")
yolmo = yolmo[yolmo$CONCEPT!="",]
kagate$Y = yolmo[match(kagate$CONCEPT,yolmo$CONCEPT),]$TRANSCRIPTION
d = kagate[!is.na(kagate$Y),]
d[,c("CONCEPT","TRANSCRIPTION","Y"),]
d[,c("CONCEPT","TRANSCRIPTION","Y"), c("TURN","OPEN","WHEAT","BRAIN","OLD","COIN","BEAN","ARRIVE")]
d[d$TRANSCRIPTION %in% c("TURN","OPEN","WHEAT","BRAIN","OLD","COIN","BEAN","ARRIVE"),c("CONCEPT","TRANSCRIPTION","Y")]
d[d$CONCEPT %in% c("TURN","OPEN","WHEAT","BRAIN","OLD","COIN","BEAN","ARRIVE"),c("CONCEPT","TRANSCRIPTION","Y")]
names(x) = c("CONCEPT","Kagate","Yolmo")
x = d[d$CONCEPT %in% c("TURN","OPEN","WHEAT","BRAIN","OLD","COIN","BEAN","ARRIVE"),c("CONCEPT","TRANSCRIPTION","Y")]
names(x) = c("CONCEPT","Kagate","Yolmo")
x
mA1 = update(mA0,~.+strongftr)
summary(mA1)
